apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Change namespace, labels, and name to dev
commonLabels:
  environment: dev
namespace: dev

#Change the tag on the images
images:
- name: ghcr.io/biosimulations/account-api
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c
- name: ghcr.io/biosimulations/combine-service
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c
- name: ghcr.io/biosimulations/dispatch-api
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c
- name: ghcr.io/biosimulations/dispatch-service
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c
- name: ghcr.io/biosimulations/mail-service
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c
- name: ghcr.io/biosimulations/ontology-api
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c
- name: ghcr.io/biosimulations/platform-api
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c
- name: ghcr.io/biosimulations/simulators-api
  newTag: b3ad9f189ea51b09cb10c34419af90321613288c

#scale down dev deployment
replicas:
- count: 1
  name: account-api
- count: 2
  name: dispatch-api
- count: 2
  name: dispatch-service
- count: 2
  name: hsds
- count: 2
  name: mail-service
- count: 1
  name: ontology-api
- count: 1
  name: platform-api
- count: 1
  name: simulators-api

#Use the development version of the secrets and ingress
resources:
- dev.yml
- biosimulations-ingress.yml
- biosimulators-ingress.yml
- nats.yml
- nats-js.yml
- ./nats-jetstream-controller
- ../../secrets/dev
- ../../config/dev
- ../../base

patchesStrategicMerge:
- resources.yml
